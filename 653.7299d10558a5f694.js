"use strict";(self.webpackChunkannouncement_portal=self.webpackChunkannouncement_portal||[]).push([[653],{5123:(g,p,m)=>{m.d(p,{P:()=>c});const c=[{id:1,name:"MINISTER",displayName:"Hon'ble Minister",seniorityLevel:1,department:"Irrigation Department",description:"Highest authority in the department"},{id:2,name:"PRINCIPAL_SECRETARY",displayName:"Principal Secretary",seniorityLevel:2,department:"Irrigation Department",description:"Administrative head of the department"},{id:3,name:"CHIEF_ENGINEER_I",displayName:"Chief Engineer-I",seniorityLevel:3,department:"Technical Division",description:"Senior technical authority"},{id:4,name:"CHIEF_ENGINEER_II",displayName:"Chief Engineer-II",seniorityLevel:4,department:"Technical Division",description:"Technical division head"},{id:5,name:"SENIOR_STAFF_OFFICER",displayName:"Senior Staff Officer",seniorityLevel:5,department:"Administrative Division",description:"Senior administrative officer"},{id:6,name:"SUPERINTENDING_ENGINEER",displayName:"Superintending Engineer",seniorityLevel:6,department:"Technical Division",description:"Regional technical head"},{id:7,name:"EXECUTIVE_ENGINEER",displayName:"Executive Engineer",seniorityLevel:7,department:"Technical Division",description:"Field technical officer"},{id:8,name:"ASSISTANT_ENGINEER",displayName:"Assistant Engineer",seniorityLevel:8,department:"Technical Division",description:"Junior technical officer"},{id:9,name:"JUNIOR_ENGINEER",displayName:"Junior Engineer",seniorityLevel:9,department:"Technical Division",description:"Entry-level technical position"},{id:10,name:"CLERICAL_STAFF",displayName:"Clerical Staff",seniorityLevel:10,department:"Administrative Division",description:"Administrative support staff"}]},5565:(g,p,m)=>{m.d(p,{l:()=>h});var c=m(4946),u=m(7879);let h=(()=>{class l{constructor(t){this.hierarchicalAdminService=t,this.ADMIN_SESSION_KEY="announcement-portal-admin-session",this.legacyAdminCredentials={username:"admin",password:"admin123"},this.isLoggedIn=(0,c.tdS)(this.loadAdminSession()),this.currentAdminSignal=(0,c.tdS)(null),this.isLoggedIn$=this.isLoggedIn.asReadonly(),this.currentAdmin$=this.currentAdminSignal.asReadonly(),this.loadCurrentAdmin()}loadAdminSession(){return null!==this.hierarchicalAdminService.getCurrentAdmin()}loadCurrentAdmin(){const t=this.hierarchicalAdminService.getCurrentAdmin();t&&(this.currentAdminSignal.set(t),this.isLoggedIn.set(!0))}login(t,e){const n=this.hierarchicalAdminService.login(t,e);if(n)return this.currentAdminSignal.set(n),this.isLoggedIn.set(!0),!0;if((t===this.legacyAdminCredentials.username||"admin@announcement.com"===t)&&e===this.legacyAdminCredentials.password){const r=this.hierarchicalAdminService.getAdminById("admin-legacy");if(r)return this.currentAdminSignal.set(r),this.isLoggedIn.set(!0),!0}return!1}logout(){this.hierarchicalAdminService.logout(),this.isLoggedIn.set(!1),this.currentAdminSignal.set(null)}isAuthenticated(){return this.isLoggedIn()}getCurrentAdmin(){return this.currentAdminSignal()}canEditAnnouncement(t){const e=this.getCurrentAdmin();return!!e&&this.hierarchicalAdminService.canEditAnnouncement(e,t)}canDeleteAnnouncement(t){const e=this.getCurrentAdmin();return!!e&&this.hierarchicalAdminService.canDeleteAnnouncement(e,t)}canViewAnnouncement(t){const e=this.getCurrentAdmin();return!!e&&this.hierarchicalAdminService.canViewAnnouncement(e,t)}}return l.\u0275fac=function(t){return new(t||l)(c.LFG(u.X))},l.\u0275prov=c.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},9615:(g,p,m)=>{m.d(p,{X:()=>l});var c=m(4946),u=m(5123),h=m(7879);let l=(()=>{class o{constructor(e){this.hierarchicalAdminService=e,this.STORAGE_KEY="announcement-portal-announcements",this.announcements=(0,c.tdS)(this.loadAnnouncements()),this.announcements$=this.announcements.asReadonly()}loadAnnouncements(){const e=localStorage.getItem(this.STORAGE_KEY);let n=e?JSON.parse(e):[];if(n=n.map(i=>{if(!i.createdBy){const r=this.hierarchicalAdminService.getAdminById("admin-legacy");return{...i,createdBy:r||{id:"system",username:"system",email:"system@announcement.com",fullName:"System Administrator",role:u.P[2],department:"IT Division",isActive:!0,createdAt:new Date,password:""},isPublic:void 0===i.isPublic||i.isPublic,priority:i.priority||"medium"}}return i}),0===n.length){const i=this.hierarchicalAdminService.getAdminById("admin-legacy");n.push({id:"1",title:"\u0938\u094d\u0935\u093e\u0917\u0924 \u0939\u0948 UPID \u0938\u0942\u091a\u0928\u093e \u092a\u094b\u0930\u094d\u091f\u0932 \u092e\u0947\u0902! | Welcome to UPID Suchana Portal!",content:"\u092f\u0939 \u092a\u094b\u0930\u094d\u091f\u0932 \u0909\u0924\u094d\u0924\u0930 \u092a\u094d\u0930\u0926\u0947\u0936 \u0938\u093f\u0902\u091a\u093e\u0908 \u0935\u093f\u092d\u093e\u0917 \u0915\u0947 \u0938\u092d\u0940 \u0938\u094d\u0924\u0930\u094b\u0902 \u092a\u0930 \u092a\u0926\u093e\u0928\u0941\u0915\u094d\u0930\u092e\u093f\u0924 \u0938\u0902\u091a\u093e\u0930 \u0915\u094b \u0938\u0915\u094d\u0937\u092e \u092c\u0928\u093e\u0924\u093e \u0939\u0948\u0964 \u0905\u0927\u093f\u0915\u093e\u0930\u0940 \u0935\u0930\u093f\u0937\u094d\u0920\u0924\u093e \u0915\u0947 \u0906\u0927\u093e\u0930 \u092a\u0930 \u0909\u092a\u092f\u0941\u0915\u094d\u0924 \u092a\u0939\u0941\u0902\u091a \u0928\u093f\u092f\u0902\u0924\u094d\u0930\u0923 \u0915\u0947 \u0938\u093e\u0925 \u092e\u0939\u0924\u094d\u0935\u092a\u0942\u0930\u094d\u0923 \u0905\u092a\u0921\u0947\u091f, \u0926\u0938\u094d\u0924\u093e\u0935\u0947\u091c\u093c \u0914\u0930 \u092a\u0930\u093f\u092a\u0924\u094d\u0930 \u0938\u093e\u091d\u093e \u0915\u0930 \u0938\u0915\u0924\u0947 \u0939\u0948\u0902\u0964 | This portal enables hierarchical communication across all levels of the UP Irrigation Department. Officers can share important updates, documents, and circulars with appropriate access controls based on seniority.",createdAt:new Date,updatedAt:new Date,likes:0,likedBy:[],attachments:[],createdBy:i||{id:"system",username:"system",email:"system@announcement.com",fullName:"System Administrator",role:u.P[2],department:"IT Division",isActive:!0,createdAt:new Date,password:""},isPublic:!0,priority:"high"}),this.saveAnnouncements(n)}return n}saveAnnouncements(e){const n=e||this.announcements();localStorage.setItem(this.STORAGE_KEY,JSON.stringify(n))}getLatestAnnouncement(){const e=this.announcements();return e.length>0?e[e.length-1]:null}getAllAnnouncements(){return this.announcements()}createOrUpdateAnnouncement(e,n,i=[],r){const a=new Date,s=r||this.hierarchicalAdminService.getCurrentAdmin(),d=this.getLatestAnnouncement();if(!s)throw new Error("No authenticated admin found");if(d){if(!this.canEditAnnouncement(d,s))throw new Error("You do not have permission to edit this announcement");{const f={...d,title:e.trim(),content:n.trim(),updatedAt:a,attachments:i};this.announcements.update(v=>v.map(y=>y.id===d.id?f:y))}}else{const f={id:Date.now().toString(),title:e.trim(),content:n.trim(),createdAt:a,updatedAt:a,likes:0,likedBy:[],attachments:i,createdBy:s,isPublic:!0,priority:"medium"};this.announcements.update(v=>[...v,f])}return this.saveAnnouncements(),this.getLatestAnnouncement()}createNewAnnouncement(e,n,i=[],r="medium",a=!0){const s=new Date,d=this.hierarchicalAdminService.getCurrentAdmin();if(!d)throw new Error("No authenticated admin found");const A={id:Date.now().toString(),title:e.trim(),content:n.trim(),createdAt:s,updatedAt:s,likes:0,likedBy:[],attachments:i,createdBy:d,isPublic:a,priority:r};return this.announcements.update(f=>[...f,A]),this.saveAnnouncements(),A}updateAnnouncement(e,n,i,r=[]){const a=new Date;let s=null;return this.announcements.update(d=>d.map(A=>A.id===e?(s={...A,title:n.trim(),content:i.trim(),updatedAt:a,attachments:r},s):A)),this.saveAnnouncements(),s}deleteAnnouncement(e){const n=this.announcements().length;return this.announcements.update(i=>i.filter(r=>r.id!==e)),this.saveAnnouncements(),this.announcements().length<n}deleteLatestAnnouncement(){const e=this.getLatestAnnouncement();return!!e&&this.deleteAnnouncement(e.id)}toggleLike(e,n){let i=!1;return this.announcements.update(r=>r.map(a=>a.id===e?a.likedBy.indexOf(n)>-1?{...a,likes:a.likes-1,likedBy:a.likedBy.filter(d=>d!==n)}:(i=!0,{...a,likes:a.likes+1,likedBy:[...a.likedBy,n]}):a)),this.saveAnnouncements(),i}hasUserLiked(e,n){const i=this.announcements().find(r=>r.id===e);return!!i&&i.likedBy.includes(n)}hasAnnouncements(){return this.announcements().length>0}syncFileDownloads(e){this.announcements.update(n=>n.map(i=>({...i,attachments:i.attachments.map(r=>{const a=e.getFile(r.id);return a?{...r,downloads:a.downloads}:r})}))),this.saveAnnouncements()}updateFileDownloadCount(e){this.announcements.update(n=>n.map(i=>({...i,attachments:i.attachments.map(r=>r.id===e?{...r,downloads:r.downloads+1}:r)}))),this.saveAnnouncements()}clearAllData(){this.announcements.set([]),localStorage.removeItem(this.STORAGE_KEY)}getAnnouncementsForCurrentAdmin(){const e=this.hierarchicalAdminService.getCurrentAdmin();return e?this.announcements().filter(n=>this.hierarchicalAdminService.canViewAnnouncement(e,n.createdBy)):[]}getSubordinateAnnouncements(){const e=this.hierarchicalAdminService.getCurrentAdmin();return e?this.announcements().filter(n=>n.createdBy.role.seniorityLevel>e.role.seniorityLevel):[]}getAnnouncementsByOfficer(e){return this.announcements().filter(n=>n.createdBy.id===e)}canEditAnnouncement(e,n){return this.hierarchicalAdminService.canEditAnnouncement(n,e.createdBy)}canDeleteAnnouncement(e,n){return this.hierarchicalAdminService.canDeleteAnnouncement(n,e.createdBy)}canViewAnnouncement(e,n){return this.hierarchicalAdminService.canViewAnnouncement(n,e.createdBy)}getAnnouncementsByDepartment(e){return this.announcements().filter(n=>n.createdBy.department===e)}getAnnouncementsByPriority(e){return this.announcements().filter(n=>n.priority===e)}getPublicAnnouncements(){return this.announcements().filter(e=>e.isPublic)}}return o.\u0275fac=function(e){return new(e||o)(c.LFG(h.X))},o.\u0275prov=c.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()},6644:(g,p,m)=>{m.d(p,{I:()=>h});var c=m(5861),u=m(4946);let h=(()=>{class l{constructor(){this.FILE_STORAGE_KEY="announcement-portal-files",this.FILE_ANALYTICS_KEY="announcement-portal-file-analytics",this.files=(0,u.tdS)(this.loadFiles()),this.analytics=(0,u.tdS)(this.loadAnalytics()),this.files$=this.files.asReadonly(),this.analytics$=this.analytics.asReadonly()}loadFiles(){const t=localStorage.getItem(this.FILE_STORAGE_KEY);return t?JSON.parse(t):[]}loadAnalytics(){const t=localStorage.getItem(this.FILE_ANALYTICS_KEY);return t?JSON.parse(t):[]}saveFiles(){localStorage.setItem(this.FILE_STORAGE_KEY,JSON.stringify(this.files()))}saveAnalytics(){localStorage.setItem(this.FILE_ANALYTICS_KEY,JSON.stringify(this.analytics()))}uploadFile(t){var e=this;return(0,c.Z)(function*(){return new Promise((n,i)=>{if(t.size>10485760)return void i(new Error("File size exceeds 10MB limit"));const r=new FileReader;r.onload=()=>{const a={id:Date.now().toString()+Math.random().toString(36).substr(2,9),name:e.sanitizeFileName(t.name),originalName:t.name,type:t.type||e.getFileTypeFromExtension(t.name),size:t.size,data:r.result,uploadedAt:new Date,downloads:0,views:0,downloadedBy:[],viewedBy:[]};e.files.update(d=>[...d,a]),e.saveFiles();const s={fileId:a.id,fileName:a.originalName,totalDownloads:0,totalViews:0,downloadHistory:[],viewHistory:[]};e.analytics.update(d=>[...d,s]),e.saveAnalytics(),n(a)},r.onerror=()=>{i(new Error("Failed to read file"))},r.readAsDataURL(t)})})()}getFile(t){return this.files().find(e=>e.id===t)||null}getFilesByIds(t){return this.files().filter(e=>t.includes(e.id))}deleteFile(t){const e=this.files().length;return this.files.update(n=>n.filter(i=>i.id!==t)),this.analytics.update(n=>n.filter(i=>i.fileId!==t)),this.saveFiles(),this.saveAnalytics(),this.files().length<e}viewFile(t,e,n,i){this.getFile(t)&&(this.files.update(a=>a.map(s=>{if(s.id===t){const d=s.viewedBy.includes(e);return{...s,views:d?s.views:s.views+1,viewedBy:d?s.viewedBy:[...s.viewedBy,e]}}return s})),this.analytics.update(a=>a.map(s=>{if(s.fileId===t){const d={userId:e,userName:n,userEmail:i,timestamp:new Date,action:"view"};return{...s,totalViews:s.totalViews+1,lastViewed:new Date,viewHistory:[...s.viewHistory,d]}}return s})),this.saveFiles(),this.saveAnalytics())}downloadFile(t,e,n,i){const r=this.getFile(t);r&&(this.files.update(a=>a.map(s=>{if(s.id===t){const d=s.downloadedBy.includes(e);return{...s,downloads:s.downloads+1,downloadedBy:d?s.downloadedBy:[...s.downloadedBy,e]}}return s})),this.analytics.update(a=>a.map(s=>{if(s.fileId===t){const d={userId:e,userName:n,userEmail:i,timestamp:new Date,action:"download"};return{...s,totalDownloads:s.totalDownloads+1,lastDownloaded:new Date,downloadHistory:[...s.downloadHistory,d]}}return s})),this.saveFiles(),this.saveAnalytics(),this.onDownloadCallback&&this.onDownloadCallback(t),this.triggerFileDownload(r))}setDownloadCallback(t){this.onDownloadCallback=t}triggerFileDownload(t){const e=document.createElement("a");e.href=t.data,e.download=t.originalName,document.body.appendChild(e),e.click(),document.body.removeChild(e)}getFileAnalytics(t){return this.analytics().find(e=>e.fileId===t)||null}getAllAnalytics(){return this.analytics()}getFileIcon(t){const e=t.toLowerCase();return e.includes("pdf")?"bi-file-earmark-pdf":e.includes("excel")||e.includes("spreadsheet")||e.includes("sheet")?"bi-file-earmark-excel":e.includes("word")||e.includes("document")?"bi-file-earmark-word":e.includes("powerpoint")||e.includes("presentation")?"bi-file-earmark-ppt":e.includes("image")||e.includes("jpeg")||e.includes("jpg")||e.includes("png")||e.includes("gif")?"bi-file-earmark-image":e.includes("video")?"bi-file-earmark-play":e.includes("audio")?"bi-file-earmark-music":e.includes("text")?"bi-file-earmark-text":e.includes("zip")||e.includes("rar")||e.includes("archive")?"bi-file-earmark-zip":"bi-file-earmark"}formatFileSize(t){if(0===t)return"0 Bytes";const i=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,i)).toFixed(2))+" "+["Bytes","KB","MB","GB"][i]}sanitizeFileName(t){return t.replace(/[^a-zA-Z0-9.-]/g,"_")}getFileTypeFromExtension(t){const e=t.split(".").pop()?.toLowerCase();return{pdf:"application/pdf",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",txt:"text/plain",zip:"application/zip",rar:"application/x-rar-compressed"}[e||""]||"application/octet-stream"}clearAllData(){this.files.set([]),this.analytics.set([]),localStorage.removeItem(this.FILE_STORAGE_KEY),localStorage.removeItem(this.FILE_ANALYTICS_KEY)}}return l.\u0275fac=function(t){return new(t||l)},l.\u0275prov=u.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},7879:(g,p,m)=>{m.d(p,{X:()=>h});var c=m(4946),u=m(5123);let h=(()=>{class l{constructor(){this.STORAGE_KEY="hierarchical_admins",this.CURRENT_ADMIN_KEY="current_hierarchical_admin",this.adminUsersSignal=(0,c.tdS)([]),this.currentAdminSignal=(0,c.tdS)(null),this.initializeDefaultAdmins(),this.loadCurrentAdmin()}initializeDefaultAdmins(){const t=this.getStoredAdmins();if(0===t.length){const e=[{id:"admin-001",username:"minister",email:"minister@irrigation.up.gov.in",password:"minister123",role:u.P[0],fullName:"Hon. Irrigation Minister",employeeId:"MIN-001",department:"Irrigation Department",isActive:!0,createdAt:new Date,lastLogin:new Date},{id:"admin-002",username:"principal_secretary",email:"ps@irrigation.up.gov.in",password:"ps123",role:u.P[1],fullName:"Principal Secretary",employeeId:"PS-001",department:"Irrigation Department",isActive:!0,createdAt:new Date},{id:"admin-003",username:"ce1",email:"ce1@irrigation.up.gov.in",password:"ce1123",role:u.P[2],fullName:"Chief Engineer-I",employeeId:"CE1-001",department:"Technical Division",isActive:!0,createdAt:new Date},{id:"admin-004",username:"ce2",email:"ce2@irrigation.up.gov.in",password:"ce2123",role:u.P[3],fullName:"Chief Engineer-II",employeeId:"CE2-001",department:"Technical Division",isActive:!0,createdAt:new Date},{id:"admin-005",username:"sso",email:"sso@irrigation.up.gov.in",password:"sso123",role:u.P[4],fullName:"Senior Staff Officer",employeeId:"SSO-001",department:"Administrative Division",isActive:!0,createdAt:new Date},{id:"admin-006",username:"se",email:"se@irrigation.up.gov.in",password:"se123",role:u.P[5],fullName:"Superintending Engineer",employeeId:"SE-001",department:"Technical Division",isActive:!0,createdAt:new Date},{id:"admin-007",username:"ee",email:"ee@irrigation.up.gov.in",password:"ee123",role:u.P[6],fullName:"Executive Engineer",employeeId:"EE-001",department:"Technical Division",isActive:!0,createdAt:new Date},{id:"admin-legacy",username:"admin",email:"admin@announcement.com",password:"admin123",role:u.P[2],fullName:"System Administrator",employeeId:"ADMIN-001",department:"IT Division",isActive:!0,createdAt:new Date}];this.saveAdmins(e),this.adminUsersSignal.set(e)}else this.adminUsersSignal.set(t)}login(t,e){const i=this.adminUsersSignal().find(r=>(r.email===t||r.username===t)&&r.password===e&&r.isActive);return i?(i.lastLogin=new Date,this.currentAdminSignal.set(i),localStorage.setItem(this.CURRENT_ADMIN_KEY,JSON.stringify(i)),this.updateAdmin(i),i):null}logout(){this.currentAdminSignal.set(null),localStorage.removeItem(this.CURRENT_ADMIN_KEY)}getCurrentAdmin(){return this.currentAdminSignal()}getSubordinateAdmins(t){return this.adminUsersSignal().filter(n=>n.role.seniorityLevel>t.role.seniorityLevel&&n.isActive)}canViewAnnouncement(t,e){return t.role.seniorityLevel<=e.role.seniorityLevel}canEditAnnouncement(t,e){return t.id===e.id||t.role.seniorityLevel<e.role.seniorityLevel}canDeleteAnnouncement(t,e){return t.id===e.id||t.role.seniorityLevel<e.role.seniorityLevel}getAdminsByDepartment(){const t=this.adminUsersSignal(),e={};return t.forEach(n=>{e[n.department]||(e[n.department]=[]),e[n.department].push(n)}),Object.keys(e).forEach(n=>{e[n].sort((i,r)=>i.role.seniorityLevel-r.role.seniorityLevel)}),e}getHierarchyTree(){return this.getAdminsByDepartment()}getAllRoles(){return u.P}getRoleById(t){return u.P.find(e=>e.id===t)}getAdminById(t){return this.adminUsersSignal().find(e=>e.id===t)}loadCurrentAdmin(){const t=localStorage.getItem(this.CURRENT_ADMIN_KEY);if(t)try{const e=JSON.parse(t);this.currentAdminSignal.set(e)}catch(e){console.error("Error loading current admin:",e),localStorage.removeItem(this.CURRENT_ADMIN_KEY)}}getStoredAdmins(){const t=localStorage.getItem(this.STORAGE_KEY);if(t)try{return JSON.parse(t)}catch(e){return console.error("Error parsing stored admins:",e),[]}return[]}saveAdmins(t){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t)),this.adminUsersSignal.set(t)}updateAdmin(t){const e=this.adminUsersSignal(),n=e.findIndex(i=>i.id===t.id);-1!==n&&(e[n]=t,this.saveAdmins(e))}}return l.\u0275fac=function(t){return new(t||l)},l.\u0275prov=c.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},3076:(g,p,m)=>{m.d(p,{K:()=>u});var c=m(4946);let u=(()=>{class h{constructor(){this.STORAGE_KEY="announcement-portal-users",this.CURRENT_USER_KEY="announcement-portal-current-user",this.users=(0,c.tdS)(this.loadUsers()),this.currentUser=(0,c.tdS)(this.loadCurrentUser()),this.users$=this.users.asReadonly(),this.currentUser$=this.currentUser.asReadonly(),this.viewedUsers=(0,c.Flj)(()=>this.users().filter(o=>o.hasViewed))}loadUsers(){const o=localStorage.getItem(this.STORAGE_KEY);return o?JSON.parse(o):[]}loadCurrentUser(){const o=localStorage.getItem(this.CURRENT_USER_KEY);return o?JSON.parse(o):null}saveUsers(){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(this.users()))}saveCurrentUser(){localStorage.setItem(this.CURRENT_USER_KEY,JSON.stringify(this.currentUser()))}createUser(o,t){const e=this.users().find(i=>i.email===t);if(e)return this.currentUser.set(e),this.saveCurrentUser(),e;const n={id:Date.now().toString(),name:o.trim(),email:t.trim().toLowerCase(),hasLiked:!1,hasViewed:!1,viewedAt:new Date};return this.users.update(i=>[...i,n]),this.currentUser.set(n),this.saveUsers(),this.saveCurrentUser(),n}markAsViewed(o){this.users.update(t=>t.map(e=>e.id===o?{...e,hasViewed:!0,viewedAt:new Date}:e)),this.saveUsers()}toggleLike(o){let t=!1;return this.users.update(e=>e.map(n=>n.id===o?(t=!n.hasLiked,{...n,hasLiked:t}):n)),this.saveUsers(),t}getCurrentUser(){return this.currentUser()}logout(){this.currentUser.set(null),localStorage.removeItem(this.CURRENT_USER_KEY)}getUserById(o){return this.users().find(t=>t.id===o)}clearAllData(){this.users.set([]),this.currentUser.set(null),localStorage.removeItem(this.STORAGE_KEY),localStorage.removeItem(this.CURRENT_USER_KEY)}}return h.\u0275fac=function(o){return new(o||h)},h.\u0275prov=c.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},5861:(g,p,m)=>{function c(h,l,o,t,e,n,i){try{var r=h[n](i),a=r.value}catch(s){return void o(s)}r.done?l(a):Promise.resolve(a).then(t,e)}function u(h){return function(){var l=this,o=arguments;return new Promise(function(t,e){var n=h.apply(l,o);function i(a){c(n,t,e,i,r,"next",a)}function r(a){c(n,t,e,i,r,"throw",a)}i(void 0)})}}m.d(p,{Z:()=>u})}}]);