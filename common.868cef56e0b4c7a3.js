"use strict";(self.webpackChunkannouncement_portal=self.webpackChunkannouncement_portal||[]).push([[592],{5565:(g,p,m)=>{m.d(p,{l:()=>h});var c=m(4946);let h=(()=>{class o{constructor(){this.ADMIN_SESSION_KEY="announcement-portal-admin-session",this.adminCredentials={username:"adminIndia",password:"Indi@446"},this.isLoggedIn=(0,c.tdS)(this.loadAdminSession()),this.isLoggedIn$=this.isLoggedIn.asReadonly()}loadAdminSession(){return"true"===localStorage.getItem(this.ADMIN_SESSION_KEY)}saveAdminSession(n){n?localStorage.setItem(this.ADMIN_SESSION_KEY,"true"):localStorage.removeItem(this.ADMIN_SESSION_KEY)}login(n,t){const e=n===this.adminCredentials.username&&t===this.adminCredentials.password;return e&&(this.isLoggedIn.set(!0),this.saveAdminSession(!0)),e}logout(){this.isLoggedIn.set(!1),this.saveAdminSession(!1)}isAuthenticated(){return this.isLoggedIn()}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275prov=c.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()},9615:(g,p,m)=>{m.d(p,{X:()=>h});var c=m(4946);let h=(()=>{class o{constructor(){this.STORAGE_KEY="announcement-portal-announcements",this.announcements=(0,c.tdS)(this.loadAnnouncements()),this.announcements$=this.announcements.asReadonly()}loadAnnouncements(){const n=localStorage.getItem(this.STORAGE_KEY),t=n?JSON.parse(n):[];return 0===t.length&&(t.push({id:"1",title:"Welcome to Announcement Portal!",content:"This is your first announcement. Admin can update or delete this message anytime. Stay tuned for more exciting updates!",createdAt:new Date,updatedAt:new Date,likes:0,likedBy:[],attachments:[]}),this.saveAnnouncements(t)),t}saveAnnouncements(n){const t=n||this.announcements();localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}getLatestAnnouncement(){const n=this.announcements();return n.length>0?n[n.length-1]:null}getAllAnnouncements(){return this.announcements()}createOrUpdateAnnouncement(n,t,e=[]){const i=new Date,s=this.getLatestAnnouncement();if(s){const r={...s,title:n.trim(),content:t.trim(),updatedAt:i,attachments:e};this.announcements.update(a=>a.map(u=>u.id===s.id?r:u))}else{const r={id:Date.now().toString(),title:n.trim(),content:t.trim(),createdAt:i,updatedAt:i,likes:0,likedBy:[],attachments:e};this.announcements.update(a=>[...a,r])}return this.saveAnnouncements(),this.getLatestAnnouncement()}createNewAnnouncement(n,t,e=[]){const i=new Date,s={id:Date.now().toString(),title:n.trim(),content:t.trim(),createdAt:i,updatedAt:i,likes:0,likedBy:[],attachments:e};return this.announcements.update(l=>[...l,s]),this.saveAnnouncements(),s}updateAnnouncement(n,t,e,i=[]){const s=new Date;let l=null;return this.announcements.update(r=>r.map(a=>a.id===n?(l={...a,title:t.trim(),content:e.trim(),updatedAt:s,attachments:i},l):a)),this.saveAnnouncements(),l}deleteAnnouncement(n){const t=this.announcements().length;return this.announcements.update(e=>e.filter(i=>i.id!==n)),this.saveAnnouncements(),this.announcements().length<t}deleteLatestAnnouncement(){const n=this.getLatestAnnouncement();return!!n&&this.deleteAnnouncement(n.id)}toggleLike(n,t){let e=!1;return this.announcements.update(i=>i.map(s=>s.id===n?s.likedBy.indexOf(t)>-1?{...s,likes:s.likes-1,likedBy:s.likedBy.filter(r=>r!==t)}:(e=!0,{...s,likes:s.likes+1,likedBy:[...s.likedBy,t]}):s)),this.saveAnnouncements(),e}hasUserLiked(n,t){const e=this.announcements().find(i=>i.id===n);return!!e&&e.likedBy.includes(t)}hasAnnouncements(){return this.announcements().length>0}clearAllData(){this.announcements.set([]),localStorage.removeItem(this.STORAGE_KEY)}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275prov=c.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()},6644:(g,p,m)=>{m.d(p,{I:()=>o});var c=m(5861),h=m(4946);let o=(()=>{class d{constructor(){this.FILE_STORAGE_KEY="announcement-portal-files",this.FILE_ANALYTICS_KEY="announcement-portal-file-analytics",this.files=(0,h.tdS)(this.loadFiles()),this.analytics=(0,h.tdS)(this.loadAnalytics()),this.files$=this.files.asReadonly(),this.analytics$=this.analytics.asReadonly()}loadFiles(){const t=localStorage.getItem(this.FILE_STORAGE_KEY);return t?JSON.parse(t):[]}loadAnalytics(){const t=localStorage.getItem(this.FILE_ANALYTICS_KEY);return t?JSON.parse(t):[]}saveFiles(){localStorage.setItem(this.FILE_STORAGE_KEY,JSON.stringify(this.files()))}saveAnalytics(){localStorage.setItem(this.FILE_ANALYTICS_KEY,JSON.stringify(this.analytics()))}uploadFile(t){var e=this;return(0,c.Z)(function*(){return new Promise((i,s)=>{if(t.size>10485760)return void s(new Error("File size exceeds 10MB limit"));const l=new FileReader;l.onload=()=>{const r={id:Date.now().toString()+Math.random().toString(36).substr(2,9),name:e.sanitizeFileName(t.name),originalName:t.name,type:t.type||e.getFileTypeFromExtension(t.name),size:t.size,data:l.result,uploadedAt:new Date,downloads:0,views:0,downloadedBy:[],viewedBy:[]};e.files.update(u=>[...u,r]),e.saveFiles();const a={fileId:r.id,fileName:r.originalName,totalDownloads:0,totalViews:0,downloadHistory:[],viewHistory:[]};e.analytics.update(u=>[...u,a]),e.saveAnalytics(),i(r)},l.onerror=()=>{s(new Error("Failed to read file"))},l.readAsDataURL(t)})})()}getFile(t){return this.files().find(e=>e.id===t)||null}getFilesByIds(t){return this.files().filter(e=>t.includes(e.id))}deleteFile(t){const e=this.files().length;return this.files.update(i=>i.filter(s=>s.id!==t)),this.analytics.update(i=>i.filter(s=>s.fileId!==t)),this.saveFiles(),this.saveAnalytics(),this.files().length<e}viewFile(t,e,i,s){this.getFile(t)&&(this.files.update(r=>r.map(a=>{if(a.id===t){const u=a.viewedBy.includes(e);return{...a,views:u?a.views:a.views+1,viewedBy:u?a.viewedBy:[...a.viewedBy,e]}}return a})),this.analytics.update(r=>r.map(a=>{if(a.fileId===t){const u={userId:e,userName:i,userEmail:s,timestamp:new Date,action:"view"};return{...a,totalViews:a.totalViews+1,lastViewed:new Date,viewHistory:[...a.viewHistory,u]}}return a})),this.saveFiles(),this.saveAnalytics())}downloadFile(t,e,i,s){const l=this.getFile(t);l&&(this.files.update(r=>r.map(a=>{if(a.id===t){const u=a.downloadedBy.includes(e);return{...a,downloads:a.downloads+1,downloadedBy:u?a.downloadedBy:[...a.downloadedBy,e]}}return a})),this.analytics.update(r=>r.map(a=>{if(a.fileId===t){const u={userId:e,userName:i,userEmail:s,timestamp:new Date,action:"download"};return{...a,totalDownloads:a.totalDownloads+1,lastDownloaded:new Date,downloadHistory:[...a.downloadHistory,u]}}return a})),this.saveFiles(),this.saveAnalytics(),this.triggerFileDownload(l))}triggerFileDownload(t){const e=document.createElement("a");e.href=t.data,e.download=t.originalName,document.body.appendChild(e),e.click(),document.body.removeChild(e)}getFileAnalytics(t){return this.analytics().find(e=>e.fileId===t)||null}getAllAnalytics(){return this.analytics()}getFileIcon(t){const e=t.toLowerCase();return e.includes("pdf")?"bi-file-earmark-pdf":e.includes("excel")||e.includes("spreadsheet")||e.includes("sheet")?"bi-file-earmark-excel":e.includes("word")||e.includes("document")?"bi-file-earmark-word":e.includes("powerpoint")||e.includes("presentation")?"bi-file-earmark-ppt":e.includes("image")||e.includes("jpeg")||e.includes("jpg")||e.includes("png")||e.includes("gif")?"bi-file-earmark-image":e.includes("video")?"bi-file-earmark-play":e.includes("audio")?"bi-file-earmark-music":e.includes("text")?"bi-file-earmark-text":e.includes("zip")||e.includes("rar")||e.includes("archive")?"bi-file-earmark-zip":"bi-file-earmark"}formatFileSize(t){if(0===t)return"0 Bytes";const s=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]}sanitizeFileName(t){return t.replace(/[^a-zA-Z0-9.-]/g,"_")}getFileTypeFromExtension(t){const e=t.split(".").pop()?.toLowerCase();return{pdf:"application/pdf",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",txt:"text/plain",zip:"application/zip",rar:"application/x-rar-compressed"}[e||""]||"application/octet-stream"}clearAllData(){this.files.set([]),this.analytics.set([]),localStorage.removeItem(this.FILE_STORAGE_KEY),localStorage.removeItem(this.FILE_ANALYTICS_KEY)}}return d.\u0275fac=function(t){return new(t||d)},d.\u0275prov=h.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},3076:(g,p,m)=>{m.d(p,{K:()=>h});var c=m(4946);let h=(()=>{class o{constructor(){this.STORAGE_KEY="announcement-portal-users",this.CURRENT_USER_KEY="announcement-portal-current-user",this.users=(0,c.tdS)(this.loadUsers()),this.currentUser=(0,c.tdS)(this.loadCurrentUser()),this.users$=this.users.asReadonly(),this.currentUser$=this.currentUser.asReadonly(),this.viewedUsers=(0,c.Flj)(()=>this.users().filter(n=>n.hasViewed))}loadUsers(){const n=localStorage.getItem(this.STORAGE_KEY);return n?JSON.parse(n):[]}loadCurrentUser(){const n=localStorage.getItem(this.CURRENT_USER_KEY);return n?JSON.parse(n):null}saveUsers(){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(this.users()))}saveCurrentUser(){localStorage.setItem(this.CURRENT_USER_KEY,JSON.stringify(this.currentUser()))}createUser(n,t){const e=this.users().find(s=>s.email===t);if(e)return this.currentUser.set(e),this.saveCurrentUser(),e;const i={id:Date.now().toString(),name:n.trim(),email:t.trim().toLowerCase(),hasLiked:!1,hasViewed:!1,viewedAt:new Date};return this.users.update(s=>[...s,i]),this.currentUser.set(i),this.saveUsers(),this.saveCurrentUser(),i}markAsViewed(n){this.users.update(t=>t.map(e=>e.id===n?{...e,hasViewed:!0,viewedAt:new Date}:e)),this.saveUsers()}toggleLike(n){let t=!1;return this.users.update(e=>e.map(i=>i.id===n?(t=!i.hasLiked,{...i,hasLiked:t}):i)),this.saveUsers(),t}getCurrentUser(){return this.currentUser()}logout(){this.currentUser.set(null),localStorage.removeItem(this.CURRENT_USER_KEY)}getUserById(n){return this.users().find(t=>t.id===n)}clearAllData(){this.users.set([]),this.currentUser.set(null),localStorage.removeItem(this.STORAGE_KEY),localStorage.removeItem(this.CURRENT_USER_KEY)}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275prov=c.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()},5861:(g,p,m)=>{function c(o,d,n,t,e,i,s){try{var l=o[i](s),r=l.value}catch(a){return void n(a)}l.done?d(r):Promise.resolve(r).then(t,e)}function h(o){return function(){var d=this,n=arguments;return new Promise(function(t,e){var i=o.apply(d,n);function s(r){c(i,t,e,s,l,"next",r)}function l(r){c(i,t,e,s,l,"throw",r)}s(void 0)})}}m.d(p,{Z:()=>h})}}]);